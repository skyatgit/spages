# âœ… å‰åç«¯åˆ†ç¦»é‡æ„å®Œæˆ

## ğŸ‰ é‡æ„æ€»ç»“

å·²æˆåŠŸå°† SPages é¡¹ç›®é‡æ„ä¸ºå‰åç«¯åˆ†ç¦»çš„æ¶æ„ï¼Œå‰åç«¯å„è‡ªæ‹¥æœ‰ç‹¬ç«‹çš„ `package.json` å’Œä¾èµ–ç®¡ç†ã€‚

### ğŸ“ æ–°çš„é¡¹ç›®ç»“æ„

```
spages/
â”œâ”€â”€ backend/                 # åç«¯ç›®å½•
â”‚   â”œâ”€â”€ server/             # æœåŠ¡å™¨ä»£ç 
â”‚   â”‚   â”œâ”€â”€ index.js       # å…¥å£æ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ routes/        # API è·¯ç”±
â”‚   â”‚   â”œâ”€â”€ services/      # æ ¸å¿ƒæœåŠ¡
â”‚   â”‚   â””â”€â”€ utils/         # å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ package.json       # åç«¯ä¾èµ–ï¼ˆç‹¬ç«‹ï¼‰
â”‚   â””â”€â”€ README.md          # åç«¯æ–‡æ¡£
â”‚
â”œâ”€â”€ frontend/              # å‰ç«¯ç›®å½•
â”‚   â”œâ”€â”€ src/              # æºç 
â”‚   â”œâ”€â”€ public/           # é™æ€èµ„æº
â”‚   â”œâ”€â”€ index.html        # HTML å…¥å£
â”‚   â”œâ”€â”€ vite.config.js    # Vite é…ç½®
â”‚   â”œâ”€â”€ package.json      # å‰ç«¯ä¾èµ–ï¼ˆç‹¬ç«‹ï¼‰
â”‚   â””â”€â”€ README.md         # å‰ç«¯æ–‡æ¡£
â”‚
â”œâ”€â”€ data/                 # æ•°æ®å­˜å‚¨ï¼ˆå…±äº«ï¼‰
â”œâ”€â”€ projects/             # å·²éƒ¨ç½²çš„é¡¹ç›®ï¼ˆå…±äº«ï¼‰
â”œâ”€â”€ runtime/              # è¿è¡Œæ—¶æ•°æ®ï¼ˆå…±äº«ï¼‰
â”œâ”€â”€ package.json          # æ ¹é¡¹ç›®é…ç½®ï¼ˆç»Ÿä¸€ç®¡ç†ï¼‰
â”œâ”€â”€ README.md             # é¡¹ç›®æ€»æ–‡æ¡£
â””â”€â”€ .gitignore            # Git å¿½ç•¥è§„åˆ™
```

## ğŸ”§ ä¿®æ”¹å†…å®¹

### 1. ç›®å½•é‡ç»„

- âœ… åˆ›å»º `backend/` å’Œ `frontend/` ç›®å½•
- âœ… ç§»åŠ¨åç«¯ä»£ç åˆ° `backend/server/`
- âœ… ç§»åŠ¨å‰ç«¯ä»£ç åˆ° `frontend/src/`

### 2. package.json åˆ†ç¦»

#### æ ¹ç›®å½• `package.json`
```json
{
  "name": "spages",
  "scripts": {
    "install:all": "å®‰è£…æ‰€æœ‰ä¾èµ–",
    "dev": "åŒæ—¶å¯åŠ¨å‰åç«¯",
    "dev:backend": "ä»…å¯åŠ¨åç«¯",
    "dev:frontend": "ä»…å¯åŠ¨å‰ç«¯",
    "build:frontend": "æ„å»ºå‰ç«¯",
    "start": "å¯åŠ¨åç«¯",
    "start:prod": "ç”Ÿäº§æ¨¡å¼å¯åŠ¨"
  }
}
```

#### åç«¯ `backend/package.json`
```json
{
  "name": "spages-backend",
  "dependencies": {
    "express": "^4.21.2",
    "cors": "^2.8.5",
    "simple-git": "^3.27.0",
    "bcryptjs": "^2.4.3",
    "jsonwebtoken": "^9.0.2",
    "adm-zip": "^0.5.16",
    "axios": "^1.7.9"
  }
}
```

#### å‰ç«¯ `frontend/package.json`
```json
{
  "name": "spages-frontend",
  "dependencies": {
    "vue": "^3.5.22",
    "vue-router": "^4.5.0",
    "vue-i18n": "^10.0.4",
    "axios": "^1.7.9"
  },
  "devDependencies": {
    "vite": "^7.1.11",
    "@vitejs/plugin-vue": "^6.0.1"
  }
}
```

### 3. è·¯å¾„ä¿®æ­£

ä¿®æ”¹åç«¯ä»£ç ä¸­çš„è·¯å¾„ï¼Œä½¿å…¶æŒ‡å‘é¡¹ç›®æ ¹ç›®å½•çš„å…±äº«èµ„æºï¼š

- âœ… `backend/server/utils/config.js` - æ•°æ®ç›®å½•ï¼š`../data`
- âœ… `backend/server/services/project-manager.js` - é¡¹ç›®ç›®å½•ï¼š`../projects`
- âœ… `backend/server/services/node-manager.js` - Runtime ç›®å½•ï¼š`../runtime`
- âœ… `backend/server/utils/init.js` - ç³»ç»Ÿå‰ç«¯ sourceRootï¼š`frontend`

### 4. å‰ç«¯é…ç½®

- âœ… `frontend/vite.config.js` - API ä»£ç†é…ç½®æ­£ç¡®
- âœ… å‰ç«¯å¯ä»¥é€šè¿‡ `/api` è®¿é—®åç«¯

### 5. å¯åŠ¨æ–¹å¼è°ƒæ•´

**é‡è¦å˜åŒ–**ï¼š
- âŒ åç«¯ä¸å†è‡ªåŠ¨å¯åŠ¨å‰ç«¯
- âœ… å‰åç«¯éœ€è¦åˆ†åˆ«å¯åŠ¨ï¼ˆæˆ–ä½¿ç”¨æ ¹ç›®å½•çš„ `npm run dev` ç»Ÿä¸€å¯åŠ¨ï¼‰

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### æ–¹å¼ 1ï¼šç»Ÿä¸€å¯åŠ¨ï¼ˆæ¨èï¼‰

```bash
# åœ¨é¡¹ç›®æ ¹ç›®å½•

# 1. å®‰è£…æ‰€æœ‰ä¾èµ–
npm run install:all

# 2. åŒæ—¶å¯åŠ¨å‰åç«¯
npm run dev
```

### æ–¹å¼ 2ï¼šåˆ†åˆ«å¯åŠ¨

```bash
# ç»ˆç«¯ 1 - å¯åŠ¨åç«¯
cd backend
npm install
npm start

# ç»ˆç«¯ 2 - å¯åŠ¨å‰ç«¯
cd frontend
npm install
npm run dev
```

### ç”Ÿäº§éƒ¨ç½²

```bash
# åœ¨é¡¹ç›®æ ¹ç›®å½•

# 1. æ„å»ºå‰ç«¯
npm run build:frontend

# 2. å¯åŠ¨åç«¯ï¼ˆç”Ÿäº§æ¨¡å¼ï¼‰
npm run start:prod
```

## âœ… éªŒè¯ç»“æœ

### åç«¯
- âœ… ç«¯å£ï¼šhttp://localhost:3000
- âœ… å¥åº·æ£€æŸ¥ï¼šhttp://localhost:3000/api/health
- âœ… ç‹¬ç«‹çš„ node_modules

### å‰ç«¯
- âœ… ç«¯å£ï¼šhttp://localhost:5173
- âœ… å¼€å‘æœåŠ¡å™¨æ­£å¸¸è¿è¡Œ
- âœ… ç‹¬ç«‹çš„ node_modules
- âœ… API ä»£ç†åˆ°åç«¯æ­£å¸¸å·¥ä½œ

## ğŸ“Š æ¶æ„ä¼˜åŠ¿

### ä¹‹å‰ï¼ˆå•ä½“ç»“æ„ï¼‰
```
spages/
â”œâ”€â”€ server/           # åç«¯
â”œâ”€â”€ src/              # å‰ç«¯
â”œâ”€â”€ package.json      # æ··åˆä¾èµ–
â””â”€â”€ node_modules/     # æ··åˆçš„ä¾èµ–åŒ…
```

**é—®é¢˜**ï¼š
- âŒ å‰åç«¯ä¾èµ–æ··åœ¨ä¸€èµ·
- âŒ æ— æ³•ç‹¬ç«‹éƒ¨ç½²å‰åç«¯
- âŒ ä¾èµ–å†²çªé£é™©
- âŒ æ„å»ºå’Œéƒ¨ç½²ä¸çµæ´»

### ç°åœ¨ï¼ˆå‰åç«¯åˆ†ç¦»ï¼‰
```
spages/
â”œâ”€â”€ backend/
â”‚   â”œâ”€â”€ server/
â”‚   â”œâ”€â”€ package.json     # åç«¯ä¾èµ–
â”‚   â””â”€â”€ node_modules/    # åç«¯ä¾èµ–åŒ…
â”œâ”€â”€ frontend/
â”‚   â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ package.json     # å‰ç«¯ä¾èµ–
â”‚   â””â”€â”€ node_modules/    # å‰ç«¯ä¾èµ–åŒ…
â””â”€â”€ package.json         # ç»Ÿä¸€ç®¡ç†è„šæœ¬
```

**ä¼˜åŠ¿**ï¼š
- âœ… èŒè´£æ¸…æ™°åˆ†ç¦»
- âœ… å¯ä»¥ç‹¬ç«‹éƒ¨ç½²
- âœ… ä¾èµ–éš”ç¦»
- âœ… æ›´çµæ´»çš„éƒ¨ç½²æ–¹å¼

## ğŸ¯ éƒ¨ç½²é€‰é¡¹

### é€‰é¡¹ 1ï¼šå•æœºéƒ¨ç½²ï¼ˆç®€å•ï¼‰
```bash
# åç«¯æ‰˜ç®¡å‰ç«¯æ„å»ºäº§ç‰©
npm run build:frontend
npm run start:prod
```

### é€‰é¡¹ 2ï¼šåˆ†ç¦»éƒ¨ç½²ï¼ˆæ¨èç”Ÿäº§ï¼‰
```bash
# åç«¯éƒ¨ç½²åˆ°æœåŠ¡å™¨ A
cd backend
npm install
npm run start:prod

# å‰ç«¯éƒ¨ç½²åˆ° CDN/Nginx
cd frontend
npm run build
# å°† dist/ ä¸Šä¼ åˆ° CDN æˆ– Nginx
```

### é€‰é¡¹ 3ï¼šå®¹å™¨åŒ–éƒ¨ç½²
```dockerfile
# å¤šé˜¶æ®µæ„å»º
FROM node:24 AS frontend-builder
WORKDIR /app/frontend
COPY frontend/ .
RUN npm install && npm run build

FROM node:24
WORKDIR /app
COPY backend/ ./backend/
COPY --from=frontend-builder /app/frontend/dist ./frontend/dist
WORKDIR /app/backend
RUN npm install
EXPOSE 3000
CMD ["npm", "run", "start:prod"]
```

## ğŸ“ å¼€å‘å·¥ä½œæµ

### æ—¥å¸¸å¼€å‘
```bash
# å¯åŠ¨æ‰€æœ‰æœåŠ¡
npm run dev

# è®¿é—®
# å‰ç«¯ï¼šhttp://localhost:5173
# åç«¯ï¼šhttp://localhost:3000
```

### ä»…å‰ç«¯å¼€å‘
```bash
cd frontend
npm run dev
# åç«¯ API ä¼šé€šè¿‡ä»£ç†è®¿é—® localhost:3000
```

### ä»…åç«¯å¼€å‘
```bash
cd backend
npm start
# å¯ä»¥ç”¨ Postman æµ‹è¯• API
```

## ğŸ” æ³¨æ„äº‹é¡¹

1. **å…±äº«èµ„æº**
   - `data/`ã€`projects/`ã€`runtime/` ç›®å½•åœ¨é¡¹ç›®æ ¹ç›®å½•
   - å‰åç«¯éƒ½å¯ä»¥è®¿é—®è¿™äº›ç›®å½•

2. **ç«¯å£é…ç½®**
   - åç«¯ï¼š3000ï¼ˆå¯é€šè¿‡ç¯å¢ƒå˜é‡ä¿®æ”¹ï¼‰
   - å‰ç«¯ï¼š5173ï¼ˆå¯åœ¨ vite.config.js ä¿®æ”¹ï¼‰

3. **API ä»£ç†**
   - å¼€å‘æ¨¡å¼ï¼šå‰ç«¯é€šè¿‡ Vite ä»£ç†è®¿é—®åç«¯
   - ç”Ÿäº§æ¨¡å¼ï¼šéœ€è¦é…ç½® Nginx åå‘ä»£ç†æˆ– CORS

4. **ç¯å¢ƒå˜é‡**
   - åç«¯ï¼šä½¿ç”¨ `.env` æ–‡ä»¶ï¼ˆæ ¹ç›®å½•ï¼‰
   - å‰ç«¯ï¼šä½¿ç”¨ `.env.local` æ–‡ä»¶ï¼ˆfrontend ç›®å½•ï¼‰

## ğŸŠ æ€»ç»“

**é‡æ„å®Œæˆï¼** âœ…

å‰åç«¯å·²å®Œå…¨åˆ†ç¦»ï¼Œå„è‡ªç‹¬ç«‹ç®¡ç†ä¾èµ–å’Œé…ç½®ï¼š

- **åç«¯**ï¼šçº¯ API æœåŠ¡ï¼Œä¸“æ³¨äºä¸šåŠ¡é€»è¾‘
- **å‰ç«¯**ï¼šç‹¬ç«‹çš„ Vue åº”ç”¨ï¼Œä¸“æ³¨äºç”¨æˆ·ç•Œé¢
- **æ ¹ç›®å½•**ï¼šç»Ÿä¸€çš„å¯åŠ¨å’Œéƒ¨ç½²è„šæœ¬

**ç°åœ¨å¯ä»¥**ï¼š
- âœ… ç‹¬ç«‹å¼€å‘å‰åç«¯
- âœ… ç‹¬ç«‹éƒ¨ç½²å‰åç«¯
- âœ… ä½¿ç”¨ä¸åŒçš„æŠ€æœ¯æ ˆå‡çº§
- âœ… æ›´çµæ´»çš„æ‰©å±•å’Œç»´æŠ¤

---

**å®Œæˆæ—¶é—´**ï¼š2025-01-14  
**çŠ¶æ€**ï¼šâœ… é‡æ„å®Œæˆå¹¶éªŒè¯é€šè¿‡
